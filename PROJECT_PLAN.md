# Проект: Цифровые согласия на экскурсию

## Цели
Полностью функциональный комплекс (FastAPI + Next.js) для цифровых согласий: создание экскурсий, рассылка родителям, сбор электронных/бумажных подписей, генерация и хранение PDF.

## План работ (шаги)
1. Инициализация архитектуры репозитория (backend/, frontend/) и общие конфиги.
2. Настроить .gitignore, окружения (.env.example) и базовые README.
3. Поднять FastAPI скелет: конфигурация, dependency injection, CORS, JWT.
4. Настроить SQLAlchemy + Alembic, базовые модели (Users, Students, Excursions и т.д.).
5. Реализовать миграцию №1 с таблицами (Users, Students, Excursions, Signatures, Reminders).
6. Добавить seed-скрипт для демо-данных пользователей/классов.
7. Реализовать сервис хранения файлов и структуры archive/<year>/<class>/<excursion>/<student_id>.pdf.
8. Реализовать PDF-генерацию (ReportLab/WeasyPrint) с шаблоном согласия и вставкой подписи PNG.
9. Реализовать векторный модуль подписи: прием strokes, хранение JSON + метаданные.
10. Реализовать API для учителей: CRUD экскурсий, просмотр статусов подписей.
11. Реализовать API для админа: загрузка/обновление списка учеников из CSV/Excel.
12. Реализовать API магических ссылок/кодов для родителей (создание токена, валидация, гашение).
13. Реализовать API подписания родителем: получение PDF, отправка формы, запись подписи (B+C).
14. Реализовать напоминания (celery/apscheduler) + журналы отправки (Reminders).
15. Реализовать отметку «Бумажная версия получена» и загрузку скана PDF.
16. Покрыть бэкенд unit-тестами ключевых сценариев.
17. Создать фронтенд (Next.js 14, App Router) с страницами /admin/upload-students, /teacher/excursions, /teacher/excursions/:id, /parent/sign/:token.
18. Создать общие UI-компоненты (SignatureCanvas, PDFViewer, StatusList, Form/Modal).
19. Настроить API-клиент с автогенерацией типов (openapi-typescript, react-query fetcher).
20. Интегрировать подпись: canvas → strokes + PNG, отправка на API, предпросмотр PDF.
21. Добавить напоминания/статусы на фронте (progress bars, фильтры, печать PDF).
22. Добавить загрузку Excel/CSV в UI админа с валидацией и отправкой на API.
23. Настроить аутентификацию учителей/админов (JWT) + защищенные маршруты на фронте.
24. Настроить magic-link/код для родителей (форма ввода кода, обработка ошибок).
25. Добавить e2e-тест (Playwright) для сценария родителя и учителя.
26. Настроить Docker Compose (backend + frontend + db) и инструкции запуска.
27. Добавить мониторинг/health-check, метрики базовые.
28. Финальный аудит соответствия требованиям, ручные проверки, фиксы.
29. Обновить документацию (README, API docs, арх. описание).
30. Финальный рефакторинг и релиз.
